/*
ALTER TABLE SCHEMA.TABLE
SOME ACTION;

EXAMPLES OF ACTIONS:
ADD COLUMN_NAME DATATYPE
DROP COLUMN COLUMN_NAME
MODIFY COLUMN COLUMN_NAME DATATYPE
RENAME COLUMN OLD_COLUMN_NAME TO NEW_COLUMN_NAME
RENAME TO NEW_TABLE_NAME
...
;
*/
USE TEMP_SCHEMA;

CREATE TABLE SAMPLE_1(COL1 VARCHAR(30),COL2 INT);

INSERT INTO SAMPLE_1 VALUES('ANJALI',2002);
INSERT INTO SAMPLE_1 VALUES('ARUSHI',2003);
INSERT INTO SAMPLE_1 VALUES('ANU',2004);
INSERT INTO SAMPLE_1 VALUES('SOHAM',2005);

-- ADDING COLUMNS
ALTER TABLE SAMPLE_1 ADD COLUMN COL_ADD INTEGER;          -- SINGLE COLUMN

SELECT * FROM SAMPLE_1;

ALTER TABLE SAMPLE_1 ADD COLUMN COL_ADD_2 INTEGER, ADD COLUMN COL_3 INTEGER;     -- MULTIPLE COLUMN


-- DROPPING COLUMNS
ALTER TABLE SAMPLE_1 DROP COLUMN COL_ADD;                  -- SINGLE COLUMN

ALTER TABLE SAMPLE_1 DROP COLUMN COL_ADD_2, DROP COLUMN COL_3;   -- MULTIPLE COLUMN

SELECT * FROM SAMPLE_1;


-- MODIFY COLUMN
ALTER TABLE SAMPLE_1 MODIFY COLUMN COL2 VARCHAR(300);  -- CAN CONVERT INT TO VARCHAR
SELECT * FROM SAMPLE_1;

ALTER TABLE SAMPLE_1 MODIFY COLUMN COL1 INTEGER;       -- ERROR (CANNOT CONVERT VARCHAR TO INT)
SELECT * FROM SAMPLE_1;

ALTER TABLE SAMPLE_1 ADD COLUMN COL_AGE INTEGER;
INSERT INTO SAMPLE_1 (COL_AGE)VALUES (10);
INSERT INTO SAMPLE_1 (COL_AGE)VALUES (20);
INSERT INTO SAMPLE_1 (COL_AGE)VALUES (15);
INSERT INTO SAMPLE_1 (COL_AGE)VALUES (18);
SELECT * FROM SAMPLE_1;


-- RENAME COLUMN
ALTER TABLE SAMPLE_1 RENAME COLUMN COL1 TO NAME;
SELECT * FROM SAMPLE_1;

-- RENAME TABLE
ALTER TABLE SAMPLE_1 RENAME SAMPLE_RENAMED;
SELECT * FROM SAMPLE_RENAMED;


/* 
UPDATE TABLE_NAME
SET COLUMN1=VALUE1,COLUMN2=VALUE2 
WHERE CONDITION;
*/
USE EMPLOYEE;
SELECT * FROM EMP;
UPDATE EMP SET ENAME='GABRIELLE' WHERE EMPNO = 7839;
SELECT * FROM EMP;

-- MULTIPLE SET
UPDATE EMP SET JOB='MANAGER', SAL=10000 WHERE EMPNO=7839;
SELECT * FROM EMP;

-- USING AND 
UPDATE EMP SET SAL=9000 WHERE SAL > 5000 AND JOB='MANAGER';
SELECT * FROM EMP;


/*
DELETE FROM TABLE_NAME
WHERE CONDITION;
*/  -- IF NO CONDITION IT WILL DELETE ENTIRE TABLE
DELETE FROM EMP WHERE EMPNO= 7698;

DELETE FROM TEMP_SCHEMA.DEMO_1;  -- DELETE TABLE



-- CONSTRAINTS ----------------------------------------------------------------------
-- NOT NULL
USE TEMP_SCHEMA;
CREATE TABLE CONSTRAINTS(COL_1 INTEGER NOT NULL, COL_2 VARCHAR(255));
INSERT INTO CONSTRAINTS VALUES(1,NULL);   -- COL2 CAN BE NULL SO NO ERROR
INSERT INTO CONSTRAINTS VALUES(NULL,'ANJALI');   -- COL1 CANNOT BE NULL SO IT GIVES ERROR

ALTER TABLE CONSTRAINTS ADD COLUMN COL_ADD VARCHAR(300);
DESC CONSTRAINTS;
SELECT * FROM CONSTRAINTS;

DELETE FROM CONSTRAINTS WHERE COL_1=1;
ALTER TABLE CONSTRAINTS MODIFY COLUMN COL_ADD VARCHAR(255) NOT NULL;  -- ALTERING TABLE TO ADD NOT NULL CONSTRAINT FOR A COLUMN

-- UNIQUE CONSTRAINTS
CREATE TABLE CONSTRAINTS_DEMO(COL_1 INTEGER UNIQUE ,COL_2 VARCHAR(255));

INSERT INTO CONSTRAINTS_DEMO VALUES(1,'ANJALI');
INSERT INTO CONSTRAINTS_DEMO VALUES(1,'ARU');  -- ERROR BCOZ UNIQUE ACCEPTS ONLY UNIQUE VALUES
INSERT INTO CONSTRAINTS_DEMO VALUES(NULL,'ANJALI');  -- NO ERROR BCOZ UNIQUE ALSO ACCEPTS MULTIPLE NULL VALUES (WHEN UNIQUE AND NOT NULL THEN IT WILL NOT ACCEPT)

-- UNIQUE CONSTRAINT WITH NOT NULL
CREATE TABLE CONSTRAINTS_DEMO2(COL_1 INTEGER UNIQUE NOT NULL ,COL_2 VARCHAR(255));
INSERT INTO CONSTRAINTS_DEMO2 VALUES(NULL,'ANJALI');  -- ERROR COZ DOES NOT ACCEPT NULL VALUES

-- DEFAULT CONSTRAINT
/*
CREATE TABLE TABLE_NAME(
COL1 DATATYPE DEFAULT DEFAULT_VALUE);
*/
CREATE TABLE DEFAULT_CONSTRAINT(COL_1 INTEGER,COL_2 VARCHAR(255));

ALTER TABLE DEFAULT_CONSTRAINT MODIFY COLUMN COL_1 INTEGER DEFAULT '07';
SELECT * FROM DEFAULT_CONSTRAINT;
INSERT INTO DEFAULT_CONSTRAINT (COL_2)VALUES('SOHAM'); -- DEFAULT VALUE ADDED FOR COL_1
INSERT INTO DEFAULT_CONSTRAINT (COL_1,COL_2)VALUES(NULL,'SOHAM');  -- THIS WILL NOT ADD DEFAULT VALUE

-- CHECK CONSTRAINT
/*
CREATE TABLE TABLE_NAME(
COL1 DATATYPE CHECK(EXPRESSION),
COL2 DATATYPE CHECK(EXPRESSION)
);
*/
CREATE TABLE CHECK_CONSTRAINT2(COL_1 INTEGER CHECK (COL_1>10),COL_2 VARCHAR(255));
INSERT INTO CHECK_CONSTRAINT2 VALUES(10,'ANJALI');  -- ERROR BECOZ VALUE IS EQUAL TO 10
INSERT INTO CHECK_CONSTRAINT2 VALUES(20,'ARU');     -- NO ERROR

-- TO CHECK CONSTRAINT OF TABLE
SHOW CREATE TABLE CHECK_CONSTRAINT2 ;
-- DROPPING CONSTRAINT
ALTER TABLE CHECK_CONSTRAINT2 DROP CONSTRAINT CHECK_CONSTRAINT2_CHK_1;


-- PRIMARY KEY AND FOREIGN KEY
CREATE TABLE PRI_TABLE( COL_1 INTEGER , COL_2 VARCHAR(10), PRIMARY KEY(COL_1));
CREATE TABLE FOR_TABLE( COL_1 VARCHAR(10) , COL_2 INTEGER, FOREIGN KEY(COL_2) REFERENCES PRI_TABLE(COL_1));

INSERT INTO FOR_TABLE VALUE('APPLE',1); -- YOU CANNOT INSERT A RECORD UNTIL THE CORRESPONDING VALUE IS IN THE PK COLUMN

INSERT INTO PRI_TABLE VALUE(1,'APPLE');
SELECT * FROM PRI_TABLE;
INSERT INTO PRI_TABLE VALUE(2,'ANIMAL');

INSERT INTO PRI_TABLE VALUES(NULL,'ANIMAL'); -- PRIMARY TABLE DOES NOT ACCEPT NULL AS WELL AS DUPLICATE VALUES
INSERT INTO PRI_TABLE VALUE(2,'HAPPY');   -- ERROR

-- DROPING PRIMARY KEY DOES NOT WORK UNTIL DEPENDACNY IS REMOVED
ALTER TABLE PRI_TABLE DROP PRIMARY KEY; -- ERROR

-- DROPPING FOREIGN KEY CONSTRAINT
SHOW CREATE TABLE FOR_TABLE ;
ALTER TABLE FOR_TABLE DROP CONSTRAINT FOR_TABLE_IBFK_1; -- DROPS FOREIGN KEY CONSTRAINT

-- ADDING FOREIGN KEY
ALTER TABLE FOR_TABLE ADD FOREIGN KEY(COL_2) REFERENCES PRI_TABLE(COL_1);



-- CREATE NEW DATABASE HR----------------------------------------------
CREATE DATABASE HR;
CREATE TABLE HR.EMP
(
	EMP_NO INT,
    E_NAME VARCHAR(255),
    JOB VARCHAR(255),
    MGR INT,
    HIRE_DATE DATE,
    SAL DECIMAL(10,2),
    COMM DECIMAL(10,2),
    DEPT_NO INT 
);

INSERT INTO HR.EMP VALUES
(7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800.00, NULL, 20),
    (7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600.00, 300.00, 30),
    (7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250.00, 500.00, 30),
    (7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975.00, NULL, 20),
    (7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250.00, 1400.00, 30),
    (7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850.00, NULL, 30),
    (7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450.00, NULL, 10),
    (7788, 'SCOTT', 'ANALYST', 7566, '1982-12-09', 3000.00, NULL, 20),
    (7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000.00, NULL, 10),
    (7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500.00, 0.00, 30),
    (7876, 'ADAMS', 'CLERK', 7788, '1983-01-12', 1100.00, NULL, 20),
    (7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950.00, NULL, 30),
    (7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000.00, NULL, 20),
    (7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300.00, NULL, 10);

SELECT * FROM HR.EMP;

CREATE TABLE HR.DEPT(
DEPT_ID INT,
D_NAME VARCHAR(255),
LOC VARCHAR(255));

INSERT INTO HR.DEPT VALUES 
(10,'ACCOUNTING','NEW YORK'),
(20,'RESEARCH','DALLAS'),
(30,'SALES','CHICAGO'),
(40,'OPERATIONS','BOSTON');

SELECT * FROM HR.DEPT;

CREATE DATABASE CUSTOMER_ORDERS;
USE CUSTOMER_ORDERS;

CREATE TABLE ORDERS(
ORDER_ID INTEGER,
ORDER_DATETIME VARCHAR(255),
CUSTOMER_ID INTEGER,
ORDER_STATUS VARCHAR(10),
STORE_ID INTEGER);



-- ASSIIGNMENT-----------------------------------------------------------
CREATE DATABASE ASSIGNMENT_SCHEMA;
USE ASSIGNMENT_SCHEMA;

-- CREATE TABLE

CREATE TABLE MOVIE_RATINGS(COL_1 INTEGER,COL_2 VARCHAR(255));
ALTER TABLE MOVIE_RATINGS ADD COLUMN RATINGS VARCHAR(255);

-- ADD VALUES

INSERT INTO MOVIE_RATINGS VALUES(1,'PUSHPA',5);
INSERT INTO MOVIE_RATINGS VALUES(2,'BAHUBALI',5);

-- ADD CONSTRAINT 

ALTER TABLE MOVIE_RATINGS MODIFY COLUMN COL_2 VARCHAR(255) UNIQUE;
INSERT INTO MOVIE_RATINGS VALUES(3,'BAHUBALI',5); -- ERROR BECOZ BAHUBALI IS ALREADY ADDED

-- NOTE WHILE APLLYING NOT NULL CONSTRANT MAKE SURE THERE IS NO VALUES IN THE COLUMN
-- ADD NOT NULL AND RATINGS>0 CONSTRAINT

ALTER TABLE MOVIE_RATINGS MODIFY COLUMN RATINGS VARCHAR(255) NOT NULL;
ALTER TABLE MOVIE_RATINGS MODIFY COLUMN RATINGS VARCHAR(255) CHECK (RATINGS>0);
INSERT INTO MOVIE_RATINGS VALUES(4,'MRS',0);  -- ERROR BECOZ RATING IS 0
INSERT INTO MOVIE_RATINGS VALUES(5,'CHAVA',NULL);  -- ERROR BCOZ RATING SHOLUD NOT BE NULL
SELECT * FROM MOVIE_RATINGS;



-- SOME OPERATIONS ON CUSTOMER_ORDER DATABASE

SELECT ORDER_ID,PRODUCT_ID,UNIT_PRICE *1.2 AS CORRECTED_UNIT_PRICE,
 QUANTITY,((UNIT_PRICE * 1.2 * QUANTITY) -5) AS LINE_ITEM_AMOUNT
FROM
CUSTOMER_ORDERS.ORDER_ITEMS WHERE ((UNIT_PRICE * 1.2 * QUANTITY) -5)>100;



-- LOGICAL OPERATORS----------------------------------------------------------------
-- OR
SELECT * FROM HR.EMP WHERE (SAL>=1000) OR (SAL <=2000);

-- BETWEEN
SELECT * FROM HR.EMP WHERE (SAL>=1000) AND (SAL <=2000);
				-- OR --
SELECT * FROM HR.EMP WHERE SAL BETWEEN 1000 AND 2000;

-- IN 
SELECT * FROM HR.EMP WHERE JOB ='CLERK' OR JOB='SALESMAN';
				-- OR --
SELECT * FROM HR.EMP WHERE JOB IN('CLERK','SALESMAN');

SELECT * FROM HR.EMP WHERE SAL= 800 OR SAL=1250 OR SAL=2000;
				-- OR --
SELECT * FROM HR.EMP WHERE SAL IN (800,1250,2000);

-- COMBINE ALL OPERATORS

SELECT * FROM HR.EMP WHERE
SAL BETWEEN 1000 AND 3000 OR JOB IN ('SALESMAN','CLERK') AND COMM=1400; 

SELECT * FROM HR.EMP WHERE
(SAL BETWEEN 1000 AND 3000 OR JOB IN ('SALESMAN','CLERK')) AND COMM=1400;  -- EXECUTE ANY ONE OR BOTH CONDITIONS FROM BRAKETS AND COMPULSARY EXECUTE COMM CONDITION

-- THIS IS EQUIVALENT TO USING (=) OPERATOR
 SELECT * FROM COUNTRIES .COUNTRIES WHERE COUNTRY_NAME LIKE 'AUSTRALIA';
 
 -- SEARCHES FOR RECORDS WHERE NAME CONTAINS BRITISH
SELECT * FROM COUNTRIES .COUNTRIES WHERE COUNTRY_NAME LIKE '%BRITISH%';
 
 -- SEARCHES FOR RECORDS WHERE NAME CONTAINS COMMA
SELECT * FROM COUNTRIES .COUNTRIES WHERE COUNTRY_NAME LIKE '% %';

-- USING WHERE CLAUSE AND OPERATORS IN DML
CREATE TABLE COUNTRIES.COUNTRIES_COPY AS SELECT * FROM COUNTRIES.COUNTRIES;
SELECT * FROM COUNTRIES.COUNTRIES;

DELETE FROM COUNTRIES.COUNTRIES_COPY WHERE COUNTRY_NAME LIKE 'A%';


-- ASSIGNMENT 2------------------------------------------------------------------
USE ASSIGNMENT_SCHEMA;

CREATE TABLE DEPT_COPY AS SELECT * FROM HR.DEPT;
SELECT * FROM DEPT_COPY;

CREATE TABLE EMP_COPY AS SELECT * FROM HR.EMP;
SELECT * FROM EMP_COPY;

-- ADDING PRIMARY AND FOREIGN KEY
ALTER TABLE DEPT_COPY ADD PRIMARY KEY(DEPT_ID);
ALTER TABLE EMP_COPY ADD FOREIGN KEY(DEPT_NO) REFERENCES DEPT_COPY(DEPT_ID);


-- ASSIGNMENT 3-----------------------------------------------------------------------------------
SELECT * FROM COUNTRIES.COUNTRIES WHERE POPULATION > 200000000 ORDER BY POPULATION DESC ;

SELECT * FROM HR.EMP WHERE COMM>0 ORDER BY COMM;

SELECT * FROM CUSTOMER_ORDERS.ORDER_ITEMS WHERE QUANTITY>4 AND UNIT_PRICE>49;

-- ASSIGNMENT 4-------------------------------------------------------------------------------------
SELECT * FROM COUNTRIES.COUNTRIES;

SELECT * FROM COUNTRIES.COUNTRIES WHERE 
(POPULATION BETWEEN 100000000 AND 200000000 OR AREA_KM2>5000000) AND COUNTRY_NAME NOT LIKE '% %';

-- ASSIGNMENT 5-------------------------------------------------------------------------------------
/*
1. Create a table in the HR schema called SALES_PEOPLE. The structure of this table should be the same as 
the EMP table... with one difference:

==> Instead of the SAL and COMM columns hava a column called TOTAL_PAY
*/

USE HR;
CREATE TABLE SALES_PERSON (EMP_NO INTEGER ,E_NAME VARCHAR(255) ,JOB VARCHAR(255),
MGR VARCHAR(255),HIRE_DATE date,TOTAL_PAY INTEGER,DEPT_NO INTEGER);

/* 
 2. Insert records into the SALES_PEOPLE table from the EMP table with only the records where the job is SALESMAN. (SAL + COMM = TOTAL_PAY)
*/
INSERT INTO SALES_PERSON (EMP_NO,E_NAME,JOB,MGR,HIRE_DATE,TOTAL_PAY,DEPT_NO) SELECT 
 EMP_NO ,E_NAME ,JOB ,MGR ,HIRE_DATE, (SAL +COMM) AS TOTAL_PAY ,DEPT_NO FROM EMP WHERE JOB='SALESMAN';

-- select all records from the table
SELECT * FROM SALES_PERSON;

-- update the records to change the job title from "SALESMAN" TO "SENIOR SALESMAN" if the employee TOTAL_PAY is over 2000.
UPDATE SALES_PERSON SET JOB='SENIOR SALESMAN' WHERE TOTAL_PAY>2000;

-- select all records from the table.
SELECT * FROM SALES_PERSON;

-- drop the table
DROP TABLE SALES_PERSON;

-- ASSIGNMENT 6----------------------------------------------------------------------------------------
/*1. From the ORDER_ITEMS table in the CUSTOMER_ORDERS schema return a column called line_item_amount 
that is the unit_price multiplied by the quantity for each record. (Return all other columns as well)*/
/*2. Round the line_item_amount column to 1 decimal point.*/
USE CUSTOMER_ORDERS;

SELECT *,ROUND(UNIT_PRICE * QUANTITY) AS LINE_ITEM_AMOUNT FROM ORDER_ITEMS;

SELECT * FROM BOOKLIST.BOOKDETAIL;
truncate table BOOKLIST.BOOKDETAIL;














    